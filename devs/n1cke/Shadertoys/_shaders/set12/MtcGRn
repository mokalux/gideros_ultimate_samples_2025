{"Shader":{"ver":"0.1","info":{"id":"MtcGRn","date":"1468038024","viewed":145,"name":"[SH16A] 1st Challenge Submission","username":"gomi","description":"1st Challenge\nhttps:\/\/www.shadertoy.com\/events\/competition2016","likes":0,"published":3,"flags":0,"tags":["challenge"],"hasliked":0},"renderpass":[{"inputs":[{"id":30,"src":"\/presets\/tex16.png","ctype":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"outputs":[{"id":37,"channel":0}],"code":"#define N normalize\n#define F float\n#define V vec3\n#define Z iResolution\n\nF O = .0;\nF I = 1.;\nF H = .5;\nF T = 2.;\nV v = V(I,O,-I);\n\nV Y(in V o, in V d)\n{\n    F t = .1;\n    V r = V(O);\n    for(F i = .0; i < 64.; i++)\n    {\n        V p = o+t*d;\n        r = V(p.y,-I,O);\n        for (F c = .0; c < 25.; c++)\n        {\n            F s = mod(c,T) < H ? .4 : .25;\n            F h = length(p-V(floor(c\/5.)-T,s,mod(c,5.)-T))-s;\n            r = h < r.x ? V(h,c,s) : r;\n        }\n        if(r.x < O) break;\n        t += r.x;\n    }\n    r.x = t;\n    return r;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n\tV o = V(.85097,T,-2.87677);\n\tV n = N(.2*v.yzy-o);\n\tV c = N(n*v).zyx;\n    V d = mat3(c,cross(c,n),n)*N((T*V(fragCoord,Z.y+H)-Z)\/Z.y);\n    V a = Y(o,d);\n    V p = o+a.x*d;\n    c = a.y<O ? smoothstep(O,H,length(mod(clamp(p,-1.5,1.5)+H,I)-H))*  \n        (dot(step(I,mod(p,T)),v)==O ? V(.4) : \n        V(H)*texture2D(iChannel0,(floor(25.6*p.xz)+20.*v.xy+17.5)\/256.,-T).y) :\n        v.xyy+floor(a.y\/T)*V(-.08,.03,.06);    \n    n = a.y<O ? v.yxy : N(fract(p+a.z*v.xyx)-V(a.z));\n    o = N(V(-.6,.7,-H));\n    fragColor=vec4(pow(clamp(dot(n,o),O,I)*step(T,Y(p,o).x)*(c*V(1.2,1.02,.66)+pow(clamp(dot(reflect(d,n),o),O,I),16.))+\n              c*(H+H*n.y)*V(.25,.35,H)\n              ,V(H))\n              ,I);\n}\n","name":"Image","description":"","type":"image"}]}}