{"Shader":{"ver":"0.1","info":{"id":"XdfGDr","date":"1366935858","viewed":891,"name":"Barbarella","username":"weyland","description":"Jane Fonda and Verner Panton sitting by the lava lamp.","likes":15,"published":3,"flags":0,"tags":["distancefield","metaballs","barbarella","pink"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"id":37,"channel":0}],"code":"\/\/ Barberella ... by Weyland Yutani, dedicated to Jane Fonda and Verner Panton\n\/\/ Based on Metatunnel by FRequency, really old, might not work on your gpu\n\nprecision lowp float;\nfloat time=iGlobalTime;\n\nfloat h(vec3 q) \/\/ distance function\n{\n    float f=1.;\n\t\/\/ blobs\n    f*=distance(q,vec3(-sin(time*.181)*.5,sin(time*.253),1.));\n    f*=distance(q,vec3(-sin(time*.252)*.5,sin(time*.171),1.));\n    f*=distance(q,vec3(-sin(time*.133)*.5,sin(time*.283),1.));\n    f*=distance(q,vec3(-sin(time*.264)*.5,sin(time*.145),1.));\n\t\/\/ room\n\tf*=(cos(q.y))*(cos(q.z)+1.)*(cos(q.x+cos(q.z*3.))+1.)-.21+cos(q.z*6.+time\/20.)*cos(q.x*5.)*cos(q.y*4.5)*.3;\n    return f;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p=-1.+2.*fragCoord.xy \/ iResolution.xy;\n    vec3 o=vec3(p.x,p.y*1.25-0.3,0.);\n    vec3 d=vec3(p.x+cos(time\/20.)*0.3,p.y,1.)\/64.;\n    vec4 c=vec4(0.);\n    float t=0.;\n    for(int i=0;i<25;i++) \/\/ march\n    {\n        if(h(o+d*t)<.4)\n        {\n            t-=5.;\n            for(int j=0;j<5;j++) { if(h(o+d*t)>.4) t+=1.; } \/\/ scatter\n            vec3 e=vec3(.01,.0,.0);\n            vec3 n=vec3(.0);\n            n.x=h(o+d*t)-h(vec3(o+d*t+e.xyy));\n            n.y=h(o+d*t)-h(vec3(o+d*t+e.yxy));\n            n.z=h(o+d*t)-h(vec3(o+d*t+e.yyx));\n            n=normalize(n);\n            c+=max(dot(vec3(.0,.0,-.15),n),.0)+max(dot(vec3(.0,-.15,.15),n),.0)*.155;\n            break;\n        }\n        t+=5.;\n    }\n    fragColor=c+vec4(.3,.15,.15,1.)*(t*.03); \/\/ fleshtones\n}","name":"Image","description":"","type":"image"}]}}