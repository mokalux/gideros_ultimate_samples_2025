{"Shader":{"ver":"0.1","info":{"id":"4stSWS","date":"1461586294","viewed":182,"name":"SimpleParticles","username":"chazbg","description":"Particle emitter + fading","likes":0,"published":3,"flags":0,"tags":["particles"],"hasliked":0},"renderpass":[{"inputs":[{"id":17,"src":"\/presets\/tex12.png","ctype":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"}}],"outputs":[{"id":37,"channel":0}],"code":"float dist2(vec2 a, vec2 b)\n{\n    return dot(a - b, a - b);\n}\n\nvec2 getDir(vec2 uv)\n{\n    float delta = 0.01;\n    float n = texture2D(iChannel0, vec2(uv.x, uv.y + delta)).r;\n    float s = texture2D(iChannel0, vec2(uv.x, uv.y - delta)).r;\n    float e = texture2D(iChannel0, vec2(uv.x + delta, uv.y)).r;\n    float w = texture2D(iChannel0, vec2(uv.x - delta, uv.y)).r;\n    vec2 dir = normalize(vec2(e - w, n - s));\n    return dir;\n}\n\nvec3 drawParticles(vec2 uv, vec2 ePos, vec2 dir, float time, float duration)\n{\n    vec3 col = vec3(0.0);\n   \t\n    float r = 0.001;\n    const int particleCount = 5;\n    float delta = 3.0 \/ (duration * float(particleCount));\n    \n    \n    for (int i = 0; i < particleCount; i++)\n    {\n        float offset = float(i) \/ float(particleCount);\n        \n        vec2 pPos = ePos + mod(offset + delta * time, 1.0) * dir;\n    \tfloat fade = (1.0 - dist2(pPos, ePos));\n   \t\tcol += mix(vec3(0.2, 0.5, 0.1), vec3(0.0), smoothstep(0.0, r, dist2(uv, pPos))) * fade;\n    }\n\n    \n    return col;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy \/ iResolution.xy;\n\tuv.x *= iResolution.x \/ iResolution.y;\n    uv.x -= 0.4;\n    \n    fragColor = vec4(0.0);\n\tfragColor += vec4(drawParticles(uv, vec2(0.5, 0.0), vec2(0.0, 1.0),  mod(iGlobalTime, 3.0), 3.0),1.0);\n    fragColor += vec4(drawParticles(uv, vec2(0.5, 0.0), vec2(1.0, 1.0),  mod(iGlobalTime, 4.0), 2.0),1.0);\n    fragColor += vec4(drawParticles(uv, vec2(0.5, 0.0), vec2(-1.0, 1.0), mod(iGlobalTime, 3.0), 1.5),1.0);\n}","name":"Image","description":"","type":"image"}]}}